(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["lib-components-MapPageRoot-MapPageRoot"],{"7icJ":function(e,t,a){"use strict";a.r(t);var n=a("lwsE"),o=a.n(n),i=a("a1gu"),r=a.n(i),c=a("Nsbk"),s=a.n(c),l=a("PJYZ"),u=a.n(l),d=a("W8MJ"),m=a.n(d),p=a("7W2i"),h=a.n(p),v=a("lSNA"),f=a.n(v),g=a("23Q+"),y=a.n(g),b=a("v8/g"),x=a("Xr/R"),w=a("jj02"),F=a("yGI6"),E=a("TSYQ"),S=a.n(E),L=a("al9T"),_=a("4eNS"),C=a("jJcU"),M=a("q1tI"),T=a.n(M),I=function(e){function t(){return o()(this,t),r()(this,s()(t).apply(this,arguments))}return h()(t,e),m()(t,[{key:"render",value:function(){var e=this.props,t=e.activeForecastIndex,a=e.forecasts,n=e.onSelect,o=this.context.locale;return T.a.createElement("div",{className:"map-forecast-time-toolbar"},a.map((function(e,a){var i=a===t;if(a>=4)return null;var r=F.a.create(e.start).format("HH"),c=F.a.create(e.end).format("HH"),s=Object(C.c)(o.get("grammar/timeRange"),r,c),l="".concat(r,"–").concat(c);return T.a.createElement(L.a,{"aria-label":s,"aria-pressed":i,className:S()({"map-forecast-time-toolbar__button":!0,"map-forecast-time-toolbar__button--active":i}),disabled:i,key:e.end,onClick:function(){return n(a)},track:["forecast_map","choose_time_interval",void 0,a]},l)})))}}]),t}(T.a.Component);f()(I,"contextTypes",_.a.childContextTypes);var N=a("J4zp"),k=a.n(N),P=a("Wvx4"),j=a("FBcu"),O=a("pQ8y");function B(e){var t=e.activeForecastIndex,a=e.forecasts,n=e.onSelectActiveForecastIndex,o=e.title,i=Object(j.a)(),r=Object(M.useState)(!1),c=k()(r,2),s=c[0],l=c[1],u=function(){l(!0)},d=!1===s;return T.a.createElement("div",{className:"map-time-tray"},T.a.createElement(O.a,{in:s,timeout:300,classNames:{appear:"map-time-tray__content--appear",appearActive:"map-time-tray__content--appear-active",enter:"map-time-tray__content--enter",enterActive:"map-time-tray__content--enter-active",enterDone:"map-time-tray__content--enter-done",exit:"map-time-tray__content--exit",exitActive:"map-time-tray__content--exit-active",exitDone:"map-time-tray__content--exit-done"}},T.a.createElement("div",{className:"map-time-tray__content"},T.a.createElement("h2",{className:"map-time-tray__title"},o),T.a.createElement("button",{className:"map-time-tray__close-button","aria-label":s?i.get("map/timeSelector/close"):i.get("map/timeSelector/open"),onClick:s?function(){l(!1)}:u},T.a.createElement(P.a,{id:s?"icon-chevron-down":"icon-chevron-up",size:2})),T.a.createElement("div",{className:"map-time-tray__body"},T.a.createElement(I,{activeForecastIndex:t,forecasts:a,onSelect:n})),d&&T.a.createElement("button",{className:"map-time-tray__open-button",onClick:u},i.get("map/timeSelector/open")))))}var R=a("CZGH"),D=a.n(R),A=a("TWl/"),z=a.n(A),W=a("hd+n"),Z=a("U+lk"),H=a("NdCM"),U=a("tXKm"),G=a("Ojm/"),V=a("Xu5n"),Y=a("JW8z"),X=a("9d2U"),q=a("oscj"),J="EPSG:3575",K=[-512e4,-512e4,512e4,512e4],Q=K,$="EPSG:3857",ee=[-20026376.39,-20048966.1,20026376.39,20048966.1],te=ee,ae=250,ne=100,oe=200,ie=300,re=400,ce=500;function se(e,t){return e===$?e:new X.a({code:e,extent:t,units:"meters"})}function le(e,t){return Object(Y.p)([t.lon,t.lat],Object(Y.i)("EPSG:4326"),Object(Y.i)(e))}function ue(e,t){var a=F.a.create(t),n=e.findIndex((function(e){var t=F.a.create(e.start),n=F.a.create(e.end),o=t.isBefore(a),i=a.isBefore(n),r=a.isSame(n);return o&&(i||r)}));if(-1!==n)return n}function de(e,t,a,n){var o=ue(e.forecast,a);if(null==o)return"";var i=ee[0],r=ee[2],c=Math.abs(i)+Math.abs(r),s=y()("EPSG:4326","EPSG:3857",{x:e.position.lon,y:e.position.lat});return t.map((function(t){var a=y()("EPSG:4326","EPSG:3857",{x:t.position.lon,y:t.position.lat}),i=function(e,t,a){var n=t.x-e.x;n=Math.abs(n)<a/2?n:n-Math.sign(n)*a;var o=Math.atan2(t.y-e.y,n),i=Object(U.d)(o);return Object(U.b)(i)}(s,a,c),r=Object(H.i)(i,n.get("code"),!1),l=D()(e.position,t.position),u=z.a.round(l/1e3,0),d="".concat(u," ").concat(n.get("units/kilometer/short")),m="".concat(t.name," (").concat(d," ").concat(r,")"),p=t.forecast[o];if(p){var h=Object(W.b)({value:p.temperature.value});m="".concat(m,", ").concat(h,"°")}if(p&&p.symbol){var v=Object(Z.a)(p.symbol),f=n.get("symbols/s".concat(v.slice(0,2)));m="".concat(m,", ").concat(f)}if(p&&p.wind){var g=Object(H.b)(p.wind.speed,p.wind.direction,n.get("code"));m="".concat(m,", ").concat(g)}return m})).join(". ")}var me,pe=a("NOtv"),he=a.n(pe),ve=a("uhBA"),fe=a.n(ve),ge=function(e,t){if("undefined"!=typeof window&&"URLSearchParams"in window!=!1){var a=new URLSearchParams(window.location.search).get("debug:".concat(e));if(null!=a){var n=a.split(","),o=!0,i=!1,r=void 0;try{for(var c,s=n[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var l=c.value.split("="),u=k()(l,2),d=u[0],m=u[1];if(d===t)return{key:d,value:m}}}catch(e){i=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}}}},ye=function(e,t){return null!=ge(e,t)},be=a("6sFF"),xe=function(e,t){return t-e},we=function(e,t){return function(e,t){var a=e.toUpperCase(),n=t.toUpperCase();return a<n?-1:a>n?1:0}(t,e)},Fe=a("sEfC"),Ee=a.n(Fe),Se=a("DzJC"),Le=a.n(Se),_e=a("CvXi"),Ce=a("ouHB"),Me=a("l+a/"),Te=a("eNsl"),Ie=a("CJs6"),Ne=a("A1R+"),ke=a.n(Ne),Pe=a("gUha"),je=function(){function e(){var t=this;o()(this,e),f()(this,"cachedImages",{}),f()(this,"subscribers",{}),f()(this,"onImageLoad",(function(e){var a=t.cachedImages[e];if(null!=a){a.ready=!0,a.success=!0;var n=t.subscribers[e],o=!0,i=!1,r=void 0;try{for(var c,s=n[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){(0,c.value)(a.element)}}catch(e){i=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}delete t.subscribers[e]}})),f()(this,"onImageError",(function(e){var a=t.cachedImages[e];if(a){a.ready=!0,a.error=!0,a.src="";var n=t.subscribers[e],o=!0,i=!1,r=void 0;try{for(var c,s=n[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){(0,c.value)(a.element)}}catch(e){i=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}delete t.subscribers[e]}}))}return m()(e,[{key:"loadImage",value:function(e,t){var a=this.cachedImages[e];if(this.isCachedImageReady(a))return a.element;this.addOnImageLoadedSubscriber(e,t),null==a&&this.createImageAndStartLoading(e)}},{key:"isCachedImageReady",value:function(e){return null!=e&&e.ready}},{key:"addOnImageLoadedSubscriber",value:function(e,t){null==this.subscribers[e]&&(this.subscribers[e]=[]),!1===this.subscribers[e].includes(t)&&this.subscribers[e].push(t)}},{key:"createImageAndStartLoading",value:function(e){var t=this,a=document.createElement("img");a.onload=function(){setTimeout((function(){t.onImageLoad(e)}),100)},a.onerror=function(){t.onImageError(e)},a.src=e,this.cachedImages[e]={src:e,element:a,ready:!1,success:!1,error:!1}}}]),e}(),Oe=a("Pmt0"),Be=a("WDFe"),Re=a("bL/2"),De=a("bHcU"),Ae="-apple-system, BlinkMacSystemFont, Roboto, Helvetica, Arial, sans-serif",ze=a("tGdh"),We=a("pMSu"),Ze=a("gvXC"),He="".concat(We.a," ").concat("14px"," ").concat(Ae),Ue="".concat(We.a," ").concat("15px"," ").concat(Ae),Ge="".concat(We.a," ").concat("11px"," ").concat(Ae),Ve="".concat(We.a," ").concat("17px"," ").concat(Ae),Ye="".concat(We.a," ").concat("14px"," ").concat(Ae),Xe=function(e,t){me||(me=document.createElement("canvas"));var a=me.getContext("2d");return a.font=t,a.measureText(e).width},qe=function(){function e(t){var a=this;o()(this,e),f()(this,"activeForecastEnd",void 0),f()(this,"cachedOlFeature",void 0),f()(this,"devicePixelRatio",window.devicePixelRatio||1),f()(this,"imageCache",void 0),f()(this,"isColliding",!1),f()(this,"locale",void 0),f()(this,"locationNameTextWidth",void 0),f()(this,"mapFeature",void 0),f()(this,"olFeaturesCache",void 0),f()(this,"positionInMapProjection",void 0),f()(this,"shortestMapSize",void 0),f()(this,"windSpeedTextWidth",void 0),f()(this,"setStyle",(function(){if(null!=a.cachedOlFeature){var e=a.cachedOlFeature,t=e.olFeature,n=e.canvas;a.resetCanvas(n);var o=a.getCurrentForecast();o&&(a.drawDebugCanvas(n),a.drawDebugBoundingBoxes(n),a.drawLocationName(n),a.drawWeatherSymbol(n,o),a.drawTemperature(n,o),a.drawWindSpeed(n,o),a.drawWindDirection(n,o),a.drawDebugCrosshair(n),t.setStyle(new De.b({image:new Re.a({img:n,imgSize:[n.width,n.height],size:[n.width,n.height],scale:1/a.devicePixelRatio})})))}}));var n=t.activeForecastEnd,i=t.imageCache,r=t.locale,c=t.mapFeature,s=t.mapProjectionCode,l=t.mapSize,u=t.olFeaturesCache;this.activeForecastEnd=n,this.imageCache=i,this.locale=r,this.mapFeature=c,this.olFeaturesCache=u,this.positionInMapProjection=le(s,this.mapFeature.position),this.shortestMapSize=Math.min(l[0],l[1])}return m()(e,[{key:"show",value:function(){null==this.cachedOlFeature&&(this.cachedOlFeature=this.olFeaturesCache.createOlFeature(this.positionInMapProjection),this.setStyle())}},{key:"hide",value:function(){null!=this.cachedOlFeature&&(this.olFeaturesCache.release(this.cachedOlFeature),this.cachedOlFeature=void 0)}},{key:"getOlFeature",value:function(){if(this.cachedOlFeature)return this.cachedOlFeature.olFeature}},{key:"setForecastEnd",value:function(e){this.activeForecastEnd=e,this.windSpeedTextWidth=void 0,this.setStyle()}},{key:"setIsColliding",value:function(e){this.isColliding!==e&&(this.isColliding=e,this.setStyle())}},{key:"setMapSize",value:function(e){var t=Math.min(e[0],e[1]);this.shortestMapSize!==t&&(this.shortestMapSize=t,this.setStyle())}},{key:"getBoundingBoxes",value:function(e){var t=this.createBoundingBoxes(),a=this.positionInMapProjection[0],n=this.positionInMapProjection[1];return{mainBoundingBox:{minX:a+t.mainBoundingBoxMax.offsetLeft*e,minY:n+t.mainBoundingBoxMax.offsetTop*e,maxX:a+t.mainBoundingBoxMax.offsetRight*e,maxY:n+t.mainBoundingBoxMax.offsetBottom*e},nameBoundingBox:{minX:a+t.nameBoundingBoxMax.offsetLeft*e,minY:n+t.nameBoundingBoxMax.offsetTop*e,maxX:a+t.nameBoundingBoxMax.offsetRight*e,maxY:n+t.nameBoundingBoxMax.offsetBottom*e}}}},{key:"getPositionInMapProjection",value:function(){return this.positionInMapProjection}},{key:"getCurrentForecast",value:function(){if(null!=this.activeForecastEnd){var e=F.a.create(this.activeForecastEnd),t=!0,a=!1,n=void 0;try{for(var o,i=this.mapFeature.forecast[Symbol.iterator]();!(t=(o=i.next()).done);t=!0){var r=o.value,c=F.a.create(r.start),s=F.a.create(r.end);if(e.diff(c)>=0&&e.diff(s)<=0)return r}}catch(e){a=!0,n=e}finally{try{t||null==i.return||i.return()}finally{if(a)throw n}}}}},{key:"getWindArrowIcon",value:function(){return this.imageCache.loadImage("/assets/images/icons/png/4x/icon-arrow-outline.png",this.setStyle)}},{key:"getWeatherSymbolIcon",value:function(e){if(null!=e.symbol){var t=Object(Z.a)(e.symbol),a="/assets/images/map/weather-symbols/".concat(t,".svg");return this.imageCache.loadImage(a,this.setStyle)}}},{key:"getContext",value:function(e){var t=e.getContext("2d");return t.restore(),t.save(),t.scale(this.devicePixelRatio,this.devicePixelRatio),t}},{key:"getCanvasSize",value:function(){var e=this.createBoundingBoxes(),t=e.nameBoundingBoxMax.offsetRight-e.nameBoundingBoxMax.offsetLeft,a=e.mainBoundingBoxMax.offsetRight-e.mainBoundingBoxMax.offsetLeft,n=Math.round(Math.max(t,a)),o=Math.abs(e.mainBoundingBoxMax.offsetTop),i=Math.abs(e.mainBoundingBoxMax.offsetBottom);return{width:n,height:Math.round(2*Math.max(o,i))}}},{key:"getCanvasCenter",value:function(e){return{x:e.width/this.devicePixelRatio/2,y:e.height/this.devicePixelRatio/2}}},{key:"getLocationName",value:function(){return"mountain"===this.mapFeature.category||"mountain_peak"===this.mapFeature.category?this.mapFeature.name.toUpperCase():this.mapFeature.name}},{key:"getLocationNameFontStyle",value:function(){return this.mapFeature.highlighted?Ve:"capital"===this.mapFeature.category||"regional_capital"===this.mapFeature.category||"city"===this.mapFeature.category||"medium_city"===this.mapFeature.category||"large_city"===this.mapFeature.category||"administration_centre"===this.mapFeature.category?Ue:"mountain"===this.mapFeature.category||"mountain_peak"===this.mapFeature.category?Ge:He}},{key:"createCombinedBoundingBoxGeometry",value:function(e,t){return[[e.offsetLeft,e.offsetTop],[e.offsetRight,e.offsetTop],[e.offsetRight,t.offsetTop],[Math.max(t.offsetRight,e.offsetRight),t.offsetTop],[Math.max(t.offsetRight,e.offsetRight),t.offsetBottom],[e.offsetRight,t.offsetBottom],[e.offsetRight,e.offsetBottom],[e.offsetLeft,e.offsetBottom],[e.offsetLeft,t.offsetBottom],[Math.min(t.offsetLeft,e.offsetLeft),t.offsetBottom],[Math.min(t.offsetLeft,e.offsetLeft),t.offsetTop],[e.offsetLeft,t.offsetTop],[e.offsetLeft,e.offsetTop]]}},{key:"getCurrentPadding",value:function(){return Object(U.e)(this.shortestMapSize,320,800,0,40)}},{key:"createBoundingBoxes",value:function(){var e=this.getCurrentPadding(),t={offsetTop:-55,offsetBottom:20,offsetLeft:-52,offsetRight:52},a={offsetTop:t.offsetTop-e,offsetBottom:t.offsetBottom+e,offsetLeft:t.offsetLeft-e,offsetRight:t.offsetRight+e},n={offsetTop:-20,offsetBottom:0,offsetLeft:-this.getLocationNameTextWidth()/2-5,offsetRight:this.getLocationNameTextWidth()/2+5};return{mainBoundingBoxMin:t,mainBoundingBoxMax:a,nameBoundingBoxMin:n,nameBoundingBoxMax:{offsetTop:n.offsetTop-e,offsetBottom:n.offsetBottom+e,offsetLeft:Math.max(n.offsetLeft-e,n.offsetLeft),offsetRight:Math.min(n.offsetRight+e,n.offsetRight)}}}},{key:"getLocationNameTextWidth",value:function(){return null==this.locationNameTextWidth&&(this.locationNameTextWidth=Xe(this.getLocationName(),this.getLocationNameFontStyle())),this.locationNameTextWidth}},{key:"getCurrentTemperature",value:function(e){var t=e.temperature.value;return{displayValue:Object(W.b)({value:t,decimal:!1}),isWarm:Object(W.c)({value:t})}}},{key:"getWindSpeedTextWidth",value:function(e){if(null==this.windSpeedTextWidth){var t=this.getWindDisplayData(e),a=this.getWindSpeedText(t.speedRounded);this.windSpeedTextWidth=Xe(a,Ye)}return this.windSpeedTextWidth}},{key:"getWindDisplayData",value:function(e){if(null==e.wind)return{speedRounded:0,direction:0,isExtreme:!1,showArrow:!1};var t=Object(Ze.b)({value:e.wind.speed,decimal:!1}),a=Object(Ze.c)({value:e.wind.speed});return{speedRounded:t,direction:e.wind.direction,isExtreme:a,showArrow:0!==t}}},{key:"getWindSpeedText",value:function(e){return"".concat(e.toString()," ").concat(this.locale.get("units/metersPerSecond/short"))}},{key:"drawDebugCrosshair",value:function(e){}},{key:"drawLocationName",value:function(e){var t=this.getCanvasCenter(e),a=this.getContext(e),n=t.x-this.getLocationNameTextWidth()/2,o=t.y+-10;a.font=this.getLocationNameFontStyle(),a.textAlign="left",a.textBaseline="middle",a.lineWidth=2,a.strokeStyle="white",a.fillStyle="black",a.strokeText(this.getLocationName(),n,o),a.fillText(this.getLocationName(),n,o)}},{key:"drawWeatherSymbol",value:function(e,t){var a=this.getWeatherSymbolIcon(t);if(a){var n=this.getContext(e),o=this.getCanvasCenter(e),i=o.x-25,r=o.y+-38-25;n.drawImage(a,i,r,50,50)}}},{key:"drawTemperature",value:function(e,t){var a=this.getContext(e),n=this.getCanvasCenter(e),o=this.getCurrentTemperature(t),i="".concat(o.displayValue,"°"),r=n.x+-20,c=n.y+10;a.font=Ye,a.textAlign="right",a.textBaseline="middle",a.lineWidth=2,a.strokeStyle="white",a.fillStyle=o.isWarm?ze.e:ze.d,a.strokeText(i,r,c),a.fillText(i,r,c)}},{key:"drawWindSpeed",value:function(e,t){var a=this.getContext(e),n=this.getCanvasCenter(e),o=this.getWindDisplayData(t),i=this.getWindSpeedText(o.speedRounded),r=n.x+-9,c=n.y+10;a.font=Ye,a.textAlign="left",a.textBaseline="middle",a.lineWidth=2,a.strokeStyle="white",a.fillStyle=ze.f,a.strokeText(i,r,c),a.fillText(i,r,c)}},{key:"drawWindDirection",value:function(e,t){var a=this.getWindDisplayData(t);if(!1!==a.showArrow){var n=this.getWindArrowIcon();if(n){var o=this.getContext(e),i=this.getCanvasCenter(e),r=i.x+-9+this.getWindSpeedTextWidth(t)+13-12.5,c=i.y+10-12.5,s=r+12.5,l=c+12.5;o.translate(s,l),o.rotate(Object(U.c)(a.direction)),o.translate(-s,-l),o.drawImage(n,r,c,25,25)}}}},{key:"resetCanvas",value:function(e){var t=this.getCanvasSize();e.width=t.width*this.devicePixelRatio,e.height=t.height*this.devicePixelRatio,this.getContext(e).clearRect(0,0,e.width,e.height)}},{key:"drawDebugCanvas",value:function(e){}},{key:"drawDebugBoundingBoxes",value:function(e){}},{key:"drawLine",value:function(e,t,a){var n=this.getCanvasCenter(e);t.beginPath();for(var o=0;o<a.length;o++){var i=a[o],r=n.x+i[0],c=n.y+i[1];0===o?t.moveTo(r,c):t.lineTo(r,c)}}}]),e}(),Je=a("TN97"),Ke=a("9ANI"),Qe=function(){function e(){o()(this,e),f()(this,"cachedOlFeatures",[])}return m()(e,[{key:"release",value:function(e){!1!==e.active&&(e.active=!1,e.canvas.width=1,e.canvas.height=1,e.canvas.getContext("2d").clearRect(0,0,e.canvas.width,e.canvas.height),e.olFeature.setStyle(new De.b({image:new Re.a({img:e.canvas,imgSize:[e.canvas.width,e.canvas.height],size:[e.canvas.width,e.canvas.height]})})))}},{key:"createOlFeature",value:function(t){var a=!0,n=!1,o=void 0;try{for(var i,r=this.cachedOlFeatures[Symbol.iterator]();!(a=(i=r.next()).done);a=!0){var c=i.value;if(!1===c.active)return c.active=!0,c.olFeature.setGeometry(new Ke.a(t)),c}}catch(e){n=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(n)throw o}}e.index+=1;var s={index:e.index,active:!0,olFeature:new Je.a({geometry:new Ke.a(t)}),canvas:document.createElement("canvas"),devicePixelRatio:devicePixelRatio};return this.cachedOlFeatures.push(s),s}}]),e}();f()(Qe,"index",-1);var $e=function(e){function t(e,a,n,i){var c;return o()(this,t),c=r()(this,s()(t).call(this)),f()(u()(c),"imageCache",void 0),f()(u()(c),"locale",void 0),f()(u()(c),"locationMapFeaturesById",{}),f()(u()(c),"map",void 0),f()(u()(c),"mapExtent",void 0),f()(u()(c),"mapProjectionCode",void 0),f()(u()(c),"olFeaturesCache",void 0),f()(u()(c),"vectorLayer",void 0),f()(u()(c),"vectorSource",void 0),c.imageCache=new je,c.locale=i,c.map=e,c.mapExtent=n,c.mapProjectionCode=a,c.olFeaturesCache=new Qe,c.vectorSource=new Be.a({overlaps:!1}),c.vectorLayer=new Oe.a({extent:c.mapExtent,source:c.vectorSource,opacity:0,zIndex:ce,style:[]}),c.map.addLayer(c.vectorLayer),c}return h()(t,e),m()(t,[{key:"destroy",value:function(){this.map.removeLayer(this.vectorLayer),this.vectorSource.clear(!0),this.vectorSource=null,this.vectorLayer=null}},{key:"show",value:function(){this.vectorLayer.setOpacity(1)}},{key:"hide",value:function(){this.vectorLayer.setOpacity(0)}},{key:"createLocationMapFeature",value:function(e){return null==this.locationMapFeaturesById[e.id]&&(this.locationMapFeaturesById[e.id]=new qe({imageCache:this.imageCache,locale:this.locale,mapFeature:e,mapProjectionCode:this.mapProjectionCode,mapSize:this.map.getSize(),olFeaturesCache:this.olFeaturesCache})),this.locationMapFeaturesById[e.id]}},{key:"getLocationMapFeatureByLocationId",value:function(e){return this.locationMapFeaturesById[e]}},{key:"showLocation",value:function(e){var t=this.getLocationMapFeatureByLocationId(e);if(null!=t){t.show();var a=t.getOlFeature();!1===this.vectorSource.hasFeature(a)&&this.vectorSource.addFeature(a)}}},{key:"hideLocation",value:function(e){var t=this.getLocationMapFeatureByLocationId(e);null!=t&&t.hide()}}]),t}(fe.a),et=he()("yr:map"),tt=200,at=-20,nt=200,ot=500,it=function(e){function t(e){var a;o()(this,t),a=r()(this,s()(t).call(this)),f()(u()(a),"abortControllers",[]),f()(u()(a),"activeForecastEnd",void 0),f()(u()(a),"api",void 0),f()(u()(a),"areMapUrlTemplate",void 0),f()(u()(a),"createMapDescriptionDebounced",void 0),f()(u()(a),"currentMapFeature",void 0),f()(u()(a),"enabled",!1),f()(u()(a),"isInteractingWithMap",!1),f()(u()(a),"layoutThrottled",void 0),f()(u()(a),"locale",void 0),f()(u()(a),"locationForecastFeatureLayer",void 0),f()(u()(a),"map",void 0),f()(u()(a),"mapExtent",void 0),f()(u()(a),"mapFeatures",[]),f()(u()(a),"mapProjectionCode",void 0),f()(u()(a),"onChangeMapDescription",void 0),f()(u()(a),"tileGridZData",{}),f()(u()(a),"tileLevels",void 0),f()(u()(a),"tree",ke()(1e3)),f()(u()(a),"vectorTileLayer",void 0),f()(u()(a),"vectorTileSource",void 0),f()(u()(a),"visibleMapFeatures",[]),f()(u()(a),"onMapMoveStart",(function(){a.layoutThrottled(),a.isInteractingWithMap=!0})),f()(u()(a),"onMapMoveEnd",(function(){a.layoutThrottled(),a.isInteractingWithMap=!1})),f()(u()(a),"onMapChangeSize",(function(){var e=a.map.getSize();if(null!=e){var t=a.map.getView().getResolution(),n=a.vectorTileSource.getTileGrid().getZForResolution(t);if(a.currentMapFeature)a.locationForecastFeatureLayer.getLocationMapFeatureByLocationId(a.currentMapFeature.id).setMapSize(e);if(a.tileGridZData[n]){var o=!0,i=!1,r=void 0;try{for(var c,s=a.mapFeatures[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var l=c.value,u=a.locationForecastFeatureLayer.getLocationMapFeatureByLocationId(l.id);u&&u.setMapSize(e)}}catch(e){i=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}}}})),f()(u()(a),"onAreaMapFeatures",(function(e,t,n){if(!1!==a.enabled){null==a.tileGridZData[t]&&(a.tileGridZData[t]={locationIds:[],tileCoordIds:[]});var o=!0,i=!1,r=void 0;try{for(var c,s=function(){var e=c.value;null==a.mapFeatures.find((function(t){return t.id===e.id}))&&a.mapFeatures.push(e),!1===a.tileGridZData[t].locationIds.includes(e.id)&&a.tileGridZData[t].locationIds.push(e.id),a.locationForecastFeatureLayer.createLocationMapFeature(e).setForecastEnd(a.activeForecastEnd)},l=e[Symbol.iterator]();!(o=(c=l.next()).done);o=!0)s()}catch(e){i=!0,r=e}finally{try{o||null==l.return||l.return()}finally{if(i)throw r}}a.mapFeatures.sort(a.compareMapFeatureByWeigthDescendingAndIdDescending),a.tileGridZData[t].tileCoordIds.push(n),a.layoutThrottled()}})),f()(u()(a),"layout",(function(){if(null!=a.currentMapFeature)if(a.isInteractingWithMap)a.layoutThrottled();else{var e=a.map.getView().getResolution(),t=a.vectorTileSource.getTileGrid().getZForResolution(e),n=a.map.getSize();if(null!=a.tileGridZData[t]){var o=[n[0]+2*tt,n[1]+2*tt],i=[n[0]+2*at,n[1]+2*at];a.tree.clear();var r=a.locationForecastFeatureLayer.getLocationMapFeatureByLocationId(a.currentMapFeature.id).getBoundingBoxes(e);a.tree.insert(r.mainBoundingBox),a.tree.insert(r.nameBoundingBox);var c=a.tileGridZData[t].locationIds.length,s=0,l=0,u=0,d="performance"in window?window.performance.now():null;a.visibleMapFeatures=[];var m=!0,p=!1,h=void 0;try{for(var v,f=a.mapFeatures[Symbol.iterator]();!(m=(v=f.next()).done);m=!0){var g=v.value,y=g.id;if(y!==a.currentMapFeature.id){var b=a.locationForecastFeatureLayer.getLocationMapFeatureByLocationId(g.id),x=b.getPositionInMapProjection();if(!1!==Object(_e.f)(a.map.getView().calculateExtent(o),x)){a.tileGridZData[t].locationIds.includes(y)&&(s+=1);var w=b.getBoundingBoxes(e);if(!1===a.tileGridZData[t].locationIds.includes(y)){var F=a.vectorTileSource.getTileGrid().getTileCoordForCoordAndZ(x,t),E=k()(F,3),S=E[0],L=E[1],_=E[2],C="".concat(S,",").concat(L,",").concat(_);if(!1===a.tileGridZData[t].tileCoordIds.includes(C))continue}if(!1!==a.tileGridZData[t].locationIds.includes(y)){l+=1;var M=a.tree.collides(w.mainBoundingBox)||a.tree.collides(w.nameBoundingBox);if(b.setIsColliding(M),!1===M&&(u+=1,a.tree.insert(w.mainBoundingBox),a.tree.insert(w.nameBoundingBox)),!1===M||ye("map","show-colliding-locations"))a.locationForecastFeatureLayer.showLocation(y),Object(_e.f)(a.map.getView().calculateExtent(i),x)&&a.visibleMapFeatures.push(g);else a.locationForecastFeatureLayer.hideLocation(y)}else a.locationForecastFeatureLayer.hideLocation(y)}else a.locationForecastFeatureLayer.hideLocation(y)}}}catch(e){p=!0,h=e}finally{try{m||null==f.return||f.return()}finally{if(p)throw h}}var T="performance"in window?window.performance.now():null;if(et("Number of map features total: ".concat(c)),et("Number of map features within map view: ".concat(s)),et("Number of map features within loaded tiles: ".concat(l)),et("Number of map features to draw: ".concat(u)),null!=T&&null!=d)et("Map collision detection duration: ".concat(T-d,"ms"));a.createMapDescriptionDebounced()}else a.layoutThrottled()}else a.layoutThrottled()})),f()(u()(a),"compareMapFeatureByWeigthDescendingAndIdDescending",(function(e,t){return e.weight===t.weight?we(e.id,t.id):xe(e.weight,t.weight)})),f()(u()(a),"createMapDescription",(function(){var e=a.visibleMapFeatures.slice(0,3);if(null!=a.currentMapFeature&&null!=a.activeForecastEnd){var t=de(a.currentMapFeature,e,a.activeForecastEnd,a.locale);a.onChangeMapDescription(t)}}));var n=e.api,i=e.areMapUrlTemplate,c=e.currentMapFeature,l=e.locale,d=e.map,m=e.mapExtent,p=e.mapProjectionCode,h=e.onChangeMapDescription,v=e.tileLevels;return a.api=n,a.areMapUrlTemplate=i,a.currentMapFeature=c,a.enabled=!0,a.locale=l,a.map=d,a.mapExtent=m,a.mapProjectionCode=p,a.onChangeMapDescription=h,a.tileLevels=v,a.locationForecastFeatureLayer=new $e(d,a.mapProjectionCode,a.mapExtent,l),a.currentMapFeature&&a.setCurrentMapFeature(a.currentMapFeature),a.layoutThrottled=Le()(a.layout,nt),a.createMapDescriptionDebounced=Ee()(a.createMapDescription,ot,{leading:!0}),a.map.on("movestart",a.onMapMoveStart),a.map.on("moveend",a.onMapMoveEnd),a.map.on("change:size",a.onMapChangeSize),a.vectorTileSource=a.createVectorTileSource(),a.vectorTileLayer=a.createVectorTileLayer(a.vectorTileSource),a.map.addLayer(a.vectorTileLayer),a}return h()(t,e),m()(t,[{key:"destroy",value:function(){var e=!0,t=!1,a=void 0;try{for(var n,o=this.abortControllers[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){n.value.abort()}}catch(e){t=!0,a=e}finally{try{e||null==o.return||o.return()}finally{if(t)throw a}}this.enabled=!1,this.map.removeLayer(this.vectorTileLayer),this.vectorTileSource=null,this.vectorTileLayer=null,this.locationForecastFeatureLayer.destroy(),this.layoutThrottled.cancel(),this.createMapDescriptionDebounced.cancel(),this.map.un("movestart",this.onMapMoveStart),this.map.un("moveend",this.onMapMoveEnd),this.map.un("change:size",this.onMapChangeSize)}},{key:"show",value:function(){this.vectorTileLayer.setOpacity(1),this.locationForecastFeatureLayer.show()}},{key:"hide",value:function(){this.vectorTileLayer.setOpacity(0),this.locationForecastFeatureLayer.hide()}},{key:"setCurrentMapFeature",value:function(e){this.currentMapFeature=e,this.locationForecastFeatureLayer.createLocationMapFeature(this.currentMapFeature).setForecastEnd(this.activeForecastEnd),this.locationForecastFeatureLayer.showLocation(this.currentMapFeature.id)}},{key:"setActiveForecastEnd",value:function(e){this.activeForecastEnd=e;var t=this.map.getView().getResolution(),a=this.vectorTileSource.getTileGrid().getZForResolution(t);this.currentMapFeature&&this.locationForecastFeatureLayer.getLocationMapFeatureByLocationId(this.currentMapFeature.id).setForecastEnd(this.activeForecastEnd);if(this.tileGridZData[a]){var n=!0,o=!1,i=void 0;try{for(var r,c=this.mapFeatures[Symbol.iterator]();!(n=(r=c.next()).done);n=!0){var s=r.value,l=this.locationForecastFeatureLayer.getLocationMapFeatureByLocationId(s.id);l&&l.setForecastEnd(this.activeForecastEnd)}}catch(e){o=!0,i=e}finally{try{n||null==c.return||c.return()}finally{if(o)throw i}}}this.createMapDescriptionDebounced()}},{key:"createVectorTileSource",value:function(){var e=this;return new Te.a({projection:se(this.mapProjectionCode,this.mapExtent),tileSize:[512,512],minZoom:this.tileLevels.min,maxZoom:this.tileLevels.max,zDirection:0,format:new Ce.a({dataProjection:se(this.mapProjectionCode,this.mapExtent),featureProjection:se(this.mapProjectionCode,this.mapExtent)}),tileGrid:Object(Ie.b)({extent:this.mapExtent,tileSize:[512,512],minZoom:this.tileLevels.min,maxZoom:this.tileLevels.max}),url:"".concat(this.api).concat(this.areMapUrlTemplate),tileLoadFunction:function(t,a){t.setLoader((function(){var n=k()(t.tileCoord,3),o=n[0],i=n[1],r=n[2],c=Object(be.a)();e.abortControllers.push(c),Object(be.b)(a,{signal:c.signal}).then((function(e){if(!1===e.ok)throw new Error("Unable to fetch tile: ".concat(a));return e.json()})).then((function(a){t.setFeatures([]);var n=Object(Pe.b)(a,e.locale.get("code")),c="".concat(o,",").concat(i,",").concat(r);e.onAreaMapFeatures(n,o,c)}),(function(){t.setFeatures([])}))}))}})}},{key:"createVectorTileLayer",value:function(e){return new Me.a({extent:this.mapExtent,source:e,zIndex:ce})}}]),t}(fe.a),rt=a("/MKj"),ct=function(e){function t(e,a){var n;o()(this,t),n=r()(this,s()(t).call(this,e)),f()(u()(n),"onSelectActiveForecastIndex",(function(e){var t=n.props.currentMapFeature,a=n.state.locationForecastLayer;if(null!=t){var o=t.forecast[e].end;a.setActiveForecastEnd(o),n.setState({activeForecastEnd:o})}})),f()(u()(n),"onChangeMapDescription",(function(e){var t=n.props,a=t.active,o=t.onChangeMapDescription;a&&o(e)}));var i=n.props,c=i.currentMapFeature,l=i.mapExtent,d=i.map,m=i.mapProjection,p=i.mapProjectionCode,h=a.locale,v=x.a.map.tileLevels[m],g=new it({map:d,mapProjectionCode:p,mapExtent:l,locale:h,currentMapFeature:c,api:x.a.api.base.client,areMapUrlTemplate:x.a.external.map[m].areaMap,onChangeMapDescription:n.onChangeMapDescription,tileLevels:v});return n.state={locationForecastLayer:g},n}return h()(t,e),m()(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){var a=e.currentMapFeature;return null==t.currentMapFeature?{activeForecastEnd:a.forecast[0].end,currentMapFeature:a}:t}}]),m()(t,[{key:"componentDidMount",value:function(){var e=this.props.active;this.toggle(e)}},{key:"componentWillUnmount",value:function(){this.state.locationForecastLayer.destroy()}},{key:"componentDidUpdate",value:function(e,t){var a=this.props.active,n=this.state,o=n.activeForecastEnd,i=n.locationForecastLayer;e.active!==a&&this.toggle(a),null==t.activeForecastEnd&&null!=o&&i.setActiveForecastEnd(o)}},{key:"render",value:function(){var e=this.props.active,t=this.state,a=t.activeForecastEnd,n=t.currentMapFeature,o=this.context.locale;if(!1===e||null==n||null==a)return null;var i=ue(n.forecast,a);if(null==i)return null;var r=n.forecast[i],c=F.a.create(r.start).format("HH"),s=F.a.create(r.end).format("HH"),l=Object(C.c)(o.get("map/timeSelector/title"),"".concat(c,"–").concat(s));return T.a.createElement("div",{className:"map-area-forecast"},T.a.createElement("div",{className:"map-area-forecast__time-overlay"},T.a.createElement("h2",{className:"map-area-forecast__time-title"},l),T.a.createElement(I,{activeForecastIndex:i,forecasts:n.forecast,onSelect:this.onSelectActiveForecastIndex})),T.a.createElement("div",{className:"map-area-forecast__time-tray"},T.a.createElement(B,{title:l,activeForecastIndex:i,forecasts:n.forecast,onSelectActiveForecastIndex:this.onSelectActiveForecastIndex})))}},{key:"toggle",value:function(e){e?this.show():this.hide()}},{key:"show",value:function(){var e=this.props.currentLocationFeatureLayer,t=this.state,a=t.activeForecastEnd,n=t.locationForecastLayer;n.show(),e.hide(),a&&n.setActiveForecastEnd(a)}},{key:"hide",value:function(){var e=this.props.currentLocationFeatureLayer;this.state.locationForecastLayer.hide(),e.show()}}]),t}(T.a.Component);f()(ct,"contextTypes",_.a.childContextTypes);var st=Object(b.a)(Object(rt.b)((function(e,t){return{isFirstRender:t.isFirstRender}}))(ct)),lt=a("pVnL"),ut=a.n(lt),dt=a("d76g");function mt(e){var t=e.min,a=e.max,n=e.value,o=e.valueText,i=e.label,r=e.onChange,c=e.onSlideEnd,s=e.onSlideStart;return T.a.createElement(dt.c,{className:"slider",domain:[t,a],values:[n],mode:1,step:1,onUpdate:function(e){r(e[0])},onChange:function(e){r(e[0])},onSlideStart:s,onSlideEnd:c},T.a.createElement(dt.b,null,(function(e){var t=e.getRailProps;return T.a.createElement("div",ut()({className:"slider__rail"},t()))})),T.a.createElement(dt.a,null,(function(e){var r=e.handles,c=e.getHandleProps;return T.a.createElement("div",{className:"slider__handles"},r.map((function(e){return T.a.createElement("div",ut()({key:e.id,className:"slider__handle",role:"slider",tabIndex:0,"aria-label":i,"aria-valuemin":t,"aria-valuemax":a,"aria-valuenow":n,"aria-valuetext":o,style:{left:"".concat(e.percent,"%")}},c(e.id)))})))})),T.a.createElement(dt.d,null,(function(e){var t=e.tracks,a=e.getTrackProps;return T.a.createElement("div",{className:"slider__tracks"},t.map((function(e){var t=e.id,n=e.source;return T.a.createElement("div",ut()({key:t,className:"slider__track",style:{width:"".concat(n.percent,"%")}},a()))})))})))}var pt=a("OaRz"),ht=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return a=r()(this,(e=s()(t)).call.apply(e,[this].concat(i))),f()(u()(a),"onChange",(function(e){var t=a.props,n=t.index,o=t.onSetFrame;n!==e&&o(e)})),a}return h()(t,e),m()(t,[{key:"render",value:function(){var e=this.props,t=e.index,a=e.isPlaying,n=e.nowIndex,o=e.onOpenInformation,i=e.onPause,r=e.onPlay,c=e.onSlideEnd,s=e.onSlideStart,l=e.times,u=this.context.locale;if(null==l[t])return null;var d=F.a.create(l[t].time).format(u.get("units/timeformat")),m=Object(C.c)(u.get("grammar/timeLabel"),d),p=l[0].diffFromNow;vt(p,90)&&(p=-90);var h=l[l.length-1].diffFromNow;return vt(h,90)&&(h=90),T.a.createElement("div",{className:"map-precipitation-toolbar"},T.a.createElement("button",{"aria-label":a?u.get("map/precipitationToolbar/pause"):u.get("map/precipitationToolbar/play"),className:"map-precipitation-toolbar__toggle-button",onClick:a?i:r,type:"button"},T.a.createElement(P.a,{className:"map-precipitation-toolbar__toggle-icon",id:a?"icon-stop":"icon-play",size:4})),T.a.createElement("div",{className:"map-precipitation-toolbar__scrubber-container"},T.a.createElement("div",{className:"map-precipitation-toolbar__scrubber"},T.a.createElement(mt,{min:0,max:l.length-1,value:t,valueText:m,label:u.get("map/precipitationToolbar/slider"),onChange:this.onChange,onSlideEnd:c,onSlideStart:s})),T.a.createElement("p",{className:"map-precipitation-toolbar__scrubber-label map-precipitation-toolbar__scrubber-label--from"},"-".concat(Math.abs(p)," ").concat(u.get("units/time/minutes/short"),".")),T.a.createElement("p",{className:"map-precipitation-toolbar__scrubber-label map-precipitation-toolbar__scrubber-label--to"},n<l.length-1?"+".concat(Math.abs(h)," ").concat(u.get("units/time/minutes/short"),"."):u.get("grammar/now")),n<l.length-1?T.a.createElement("p",{className:"map-precipitation-toolbar__scrubber-label map-precipitation-toolbar__scrubber-label--now",style:{left:"".concat(n/(l.length-1)*100,"%")}},u.get("grammar/now")):null),T.a.createElement("div",{className:"map-precipitation-toolbar__info-button"},T.a.createElement(pt.a,{onClick:o})),T.a.createElement("p",{className:"map-precipitation-toolbar__current-frame-time"},d))}}]),t}(T.a.Component);function vt(e,t){return Math.abs(e)<t+10&&Math.abs(e)>=t-10}f()(ht,"contextTypes",_.a.childContextTypes);var ft=a("yBBP"),gt=a("Ft/T"),yt=[-625e3,-419e4,128e4,-1769e3],bt=function(){function e(t,a){var n=this;o()(this,e),f()(this,"canvas",document.createElement("canvas")),f()(this,"currentFrameIndex",-1),f()(this,"frames",[]),f()(this,"layer",void 0),f()(this,"map",void 0),f()(this,"mapProjectionCode",void 0),f()(this,"source",void 0),f()(this,"onImageLoad",(function(e){var t=parseInt(e.target.getAttribute("data-frame-index"),10),a=n.frames[t];a.ready=!0,a.success=!0,a.error=!1,n.currentFrameIndex===t&&n.showFrame(t)})),f()(this,"onImageError",(function(e){var t=parseInt(e.target.getAttribute("data-frame-index"),10),a=n.frames[t];a.ready=!0,a.success=!1,a.error=!0,n.currentFrameIndex===t&&n.showFrame(t)})),f()(this,"canvasFunction",(function(e,t,a,o,i){var r=Math.round(o[0]),c=Math.round(o[1]);n.canvas.width===r&&n.canvas.height===c||(n.canvas.width=r,n.canvas.height=c);var s=n.canvas.getContext("2d");s.clearRect(0,0,n.canvas.width,n.canvas.height);var l=n.frames[n.currentFrameIndex];if(null!=l&&!0===l.success){var u=n.map.getPixelFromCoordinate([e[0],e[3]]),d=n.map.getPixelFromCoordinate([yt[0],yt[3]]),m=n.map.getPixelFromCoordinate([yt[2],yt[1]]),p=m[0]-d[0],h=m[1]-d[1],v=(d[0]-u[0])*a,f=(d[1]-u[1])*a,g=p*a,y=h*a;return s.drawImage(l.image,0,0,l.image.naturalWidth,l.image.naturalHeight,v,f,g,y),n.canvas}})),this.map=t,this.mapProjectionCode=a,this.source=new gt.a({canvasFunction:this.canvasFunction,projection:this.mapProjectionCode}),this.layer=new ft.a({source:this.source,opacity:0}),this.layer.setZIndex(oe),this.map.addLayer(this.layer)}return m()(e,[{key:"destroy",value:function(){this.map.removeLayer(this.layer),this.source=null,this.layer=null}},{key:"show",value:function(){this.layer.setOpacity(1)}},{key:"hide",value:function(){this.layer.setOpacity(0)}},{key:"addFrame",value:function(e,t,a,n,o){var i=this.frames.length;this.frames.push({index:i,url:this.createRequestUrl(e,t,a,n,o),image:document.createElement("img"),ready:!1,success:!1,error:!1})}},{key:"showFrame",value:function(e){this.currentFrameIndex=e;var t=this.frames[e];null!=this.source&&null!=t&&(!1!==t.ready?this.source.refresh():this.loadFrame(e))}},{key:"hasFrame",value:function(e){var t=this.frames[e];return null!=t&&t.ready}},{key:"loadFrame",value:function(e){var t=this.frames[e];null!=t&&(t.ready||(t.image.setAttribute("data-frame-index",e.toString()),t.image.onload=this.onImageLoad,t.image.onerror=this.onImageError,t.image.src=t.url))}},{key:"createRequestUrl",value:function(e,t,a,n,o){var i=(yt[2]-yt[0])/a,r=(yt[3]-yt[1])/a,c=e+"?SERVICE=WMS&VERSION=1.3.0&REQUEST=GetMap&FORMAT=image/png"+"&TRANSPARENT=".concat(!0)+"&LAYERS=".concat(n)+"&CRS=".concat(this.mapProjectionCode)+"&STYLES="+"&TIME=".concat(t)+"&BBOX=".concat(yt.join())+"&WIDTH=".concat(i)+"&HEIGHT=".concat(r);return o&&(c+="&modelTime=".concat(o)),c}}]),e}(),xt=a("gCi+"),wt=a("rsK4"),Ft=function(e){function t(){return o()(this,t),r()(this,s()(t).apply(this,arguments))}return h()(t,e),m()(t,[{key:"render",value:function(){var e=this.context.locale,t=Object(H.e)("precipitation"),a=t.map((function(e,a){return"".concat(e.colour," ").concat(Math.round(a/(t.length-1)*100),"%")})),n="linear-gradient(".concat(a.join(", "),")");return T.a.createElement("div",{className:"map-legend",role:"presentation"},T.a.createElement("p",{className:"map-legend__lead"},e.get("map/legend/lead")),T.a.createElement("p",{className:"map-legend__scale-heading"},e.get("map/legend/scaleHeading")),T.a.createElement("div",{className:"map-legend__scale"},T.a.createElement("div",{className:"map-legend__scale-gradient",style:Object(wt.a)("backgroundImage",n)}),T.a.createElement("ol",{className:"map-legend__scale-list"},T.a.createElement("li",{className:"map-legend__scale-item map-legend__scale-item--extreme"},e.get("map/legend/scale/extreme")),T.a.createElement("li",{className:"map-legend__scale-item map-legend__scale-item--heavy"},e.get("map/legend/scale/heavy")),T.a.createElement("li",{className:"map-legend__scale-item map-legend__scale-item--light"},e.get("map/legend/scale/light")))),T.a.createElement("p",{className:"map-legend__body"},e.get("map/legend/body")))}}]),t}(T.a.Component);f()(Ft,"contextTypes",_.a.childContextTypes);var Et=a("f2uF");function St(e){var t=e.onClose,a=Object(j.a)();return T.a.createElement(Et.a,{renderOnServer:!1,onClose:t,size:"small",title:a.get("map/types/radar/informationLabel")},T.a.createElement(Ft,null))}var Lt=350,_t=function(e){function t(e){var a;o()(this,t),a=r()(this,s()(t).call(this,e)),f()(u()(a),"animationFrameRequestId",void 0),f()(u()(a),"onPlay",(function(){a.setState({isPlaying:!0})})),f()(u()(a),"onPause",(function(){a.setState({isPlaying:!1})})),f()(u()(a),"onSlideStart",(function(){a.setState({isScrubbing:!0,isPlaying:!1})})),f()(u()(a),"onSlideEnd",(function(){a.setState({isScrubbing:!1})})),f()(u()(a),"onSetFrame",(function(e){a.showFrame(e,!1)})),f()(u()(a),"onOpenInformation",(function(){a.setState({showInformation:!0})})),f()(u()(a),"onCloseInformation",(function(){a.setState({showInformation:!1})})),f()(u()(a),"animationFrame",(function(){var e=a.state,t=e.currentFrameIndex,n=e.currentFrameStart,o=e.isPlaying,i=e.precipitationAnimationLayer,r=e.radarTimes;if((a.animationFrameRequestId=window.requestAnimationFrame(a.animationFrame),!1!==o)&&!(Date.now()-n<Lt)){var c=(t+1)%r.length;!1===i.hasFrame(c)&&i.loadFrame(c),a.showFrame(c)}})),f()(u()(a),"showFrame",(function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=a.state.precipitationAnimationLayer;a.setState({currentFrameIndex:e,currentFrameStart:Date.now(),isPlaying:t},(function(){n.showFrame(e)}))}));var n=e.map,i=e.mapProjectionCode,c=e.nowIndex,l=e.radarStatus,d=e.times,m=a.createPrecipitationAnimationLayer(n,i,d);return m.showFrame(c),a.state={currentFrameIndex:c,currentFrameStart:0,isPlaying:!1,isScrubbing:!1,mapPrecipitationState:"STATE_READY",nowIndex:c,precipitationAnimationLayer:m,radarStatus:l,radarTimes:d,showInformation:!1},a}return h()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=this.props.active;this.toggle(e),this.animationFrame()}},{key:"componentWillUnmount",value:function(){var e=this.state.precipitationAnimationLayer;null!=this.animationFrameRequestId&&window.cancelAnimationFrame(this.animationFrameRequestId),e.destroy()}},{key:"componentDidUpdate",value:function(e){var t=this.props.active;e.active!==t&&this.toggle(t)}},{key:"render",value:function(){var e=this.props.active,t=this.state,a=t.currentFrameIndex,n=t.isPlaying,o=t.mapPrecipitationState,i=t.nowIndex,r=t.radarTimes,c=t.showInformation;return!1===e?null:T.a.createElement("div",{className:"map-precipitation"},"STATE_READY"===o&&T.a.createElement("div",{className:"map-precipitation__toolbar"},T.a.createElement("div",{className:"map-precipitation__toolbar-content"},T.a.createElement(ht,{index:a,isPlaying:n,nowIndex:i,onPause:this.onPause,onPlay:this.onPlay,onSlideEnd:this.onSlideEnd,onSlideStart:this.onSlideStart,onSetFrame:this.onSetFrame,onOpenInformation:this.onOpenInformation,times:r}))),c&&T.a.createElement(St,{onClose:this.onCloseInformation}))}},{key:"toggle",value:function(e){e?this.show():this.hide()}},{key:"show",value:function(){var e=this,t=this.state,a=t.mapPrecipitationState,n=t.nowIndex,o=t.precipitationAnimationLayer,i=t.radarStatus,r=t.radarTimes,c=this.context.locale;this.showFrame(n),o.show(),(i.isError||i.isSuccess&&0===r.length)&&"STATE_READY"===a&&this.setState({mapPrecipitationState:"STATE_ERROR"},(function(){e.props.dispatch(Object(xt.a)({key:"map-precipitation-error",type:"error",title:c.get("notifications/precipitationMapError/title"),text:c.get("notifications/precipitationMapError/text")}))}))}},{key:"hide",value:function(){var e=this.props.dispatch,t=this.state.precipitationAnimationLayer;this.setState({isPlaying:!1}),t.hide(),e(Object(xt.c)("map-precipitation-error"))}},{key:"createPrecipitationAnimationLayer",value:function(e,t,a){var n=new bt(e,t),o=!0,i=!1,r=void 0;try{for(var c,s=a[Symbol.iterator]();!(o=(c=s.next()).done);o=!0){var l=c.value,u="radar_precipitation_intensity_nordic"===l.type?"wmsRadarPrecipitationIntensityNordic":"wmsRadarNowcast",d=x.a.external.map[u],m=F.a.create(l.time).utc().format("YYYY-MM-DDTHH:mm:ssZ");n.addFrame(d,m,x.a.map.resolution,l.type,l.modelTime)}}catch(e){i=!0,r=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw r}}return n}}]),t}(T.a.Component);f()(_t,"contextTypes",_.a.childContextTypes),f()(_t,"defaultProps",{times:[]});var Ct=Object(rt.b)()(_t),Mt=a("nUcq"),Tt=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return a=r()(this,(e=s()(t)).call.apply(e,[this].concat(i))),f()(u()(a),"scaleLine",void 0),f()(u()(a),"scaleLineMaxValue",void 0),f()(u()(a),"mapScaleLineRef",T.a.createRef()),f()(u()(a),"mapScaleLineMaxValueRef",T.a.createRef()),a}return h()(t,e),m()(t,[{key:"componentDidMount",value:function(){var e=this.props.map;this.scaleLine=new Mt.a({className:"map-scale-line__control",target:this.mapScaleLineRef.current}),this.scaleLineMaxValue=new Mt.a({className:"map-scale-line__max-value-control",target:this.mapScaleLineMaxValueRef.current}),e.addControl(this.scaleLine),e.addControl(this.scaleLineMaxValue)}},{key:"componentWillUnmount",value:function(){var e=this.props.map;this.scaleLine&&e.removeControl(this.scaleLine),this.scaleLineMaxValue&&e.removeControl(this.scaleLineMaxValue)}},{key:"shouldComponentUpdate",value:function(){return!1}},{key:"render",value:function(){return T.a.createElement("div",{className:"map-scale-line"},T.a.createElement("div",{className:"map-scale-line__values"},T.a.createElement("div",{className:"map-scale-line__min-value"},"0"),T.a.createElement("div",{className:"map-scale-line__max-value",ref:this.mapScaleLineMaxValueRef})),T.a.createElement("div",{className:"map-scale-line__line",ref:this.mapScaleLineRef}))}}]),t}(T.a.Component);f()(Tt,"contextTypes",_.a.childContextTypes);var It=function(e){var t=e.iconId,a=e.label,n=e.onClick;return T.a.createElement(L.a,{"aria-label":a,className:"map-toolbar-button",onClick:n},T.a.createElement(P.a,{className:"map-toolbar-button__icon",id:t,size:3}))},Nt=a("EFXb");function kt(e){var t=e.actions,a=e.theme,n=void 0===a?"default":a;return T.a.createElement("div",{className:S()({"map-button-group":!0,"map-button-group--blue":"blue"===n})},t.map((function(e){return"button"===e.type?T.a.createElement("button",{key:e.id,"aria-label":e.label,className:S()({"map-button-group__button":!0,"map-button-group__button--active":e.active}),disabled:e.disabled,onClick:e.onClick},T.a.createElement(P.a,{className:"map-button-group__icon",id:e.iconId,size:3})):T.a.createElement("a",{key:e.id,"aria-label":e.label,className:S()({"map-button-group__button":!0,"map-button-group__button--active":e.active}),href:e.href,onClick:e.onClick},T.a.createElement(P.a,{className:"map-button-group__icon",id:e.iconId,size:3}))})))}var Pt=a("wXRo");function jt(e){var t=e.location,a=e.mapType,n=Object(j.a)(),o=Object(Pt.a)(),i=Object(Nt.a)({localeCode:o,pageId:"map",subpageId:"radar",locationId:t.id,locationPath:t.urlPath}),r=Object(Nt.a)({localeCode:o,pageId:"map",subpageId:"weather",locationId:t.id,locationPath:t.urlPath});return T.a.createElement("div",{className:"map-type-toolbar"},T.a.createElement(kt,{theme:"blue",actions:[{type:"link",id:"weather",active:"weather"===a,iconId:"icon-partly-cloudy",label:n.get("map/types/weather/name"),href:r},{type:"link",id:"radar",active:"radar"===a,iconId:"icon-umbrella-open",label:n.get("map/types/radar/name"),href:i}]}))}var Ot=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return a=r()(this,(e=s()(t)).call.apply(e,[this].concat(i))),f()(u()(a),"state",{canZoomIn:!0,canZoomOut:!0}),f()(u()(a),"onMapMoveEnd",(function(){var e=a.props,t=e.map,n=e.mapType,o=t.getView().getZoom(),i=x.a.map.zoomLevels[n];a.setState({canZoomIn:o<i.max,canZoomOut:o>i.min})})),f()(u()(a),"onZoomIn",(function(){var e=a.props.map;e.getView().animate({zoom:e.getView().getZoom()+1,duration:ae})})),f()(u()(a),"onZoomOut",(function(){var e=a.props.map;e.getView().animate({zoom:e.getView().getZoom()-1,duration:ae})})),a}return h()(t,e),m()(t,[{key:"componentDidMount",value:function(){this.props.map.on("moveend",this.onMapMoveEnd)}},{key:"componentWillUnmount",value:function(){this.props.map.un("moveend",this.onMapMoveEnd)}},{key:"render",value:function(){var e=this.context.locale,t=this.state,a=t.canZoomIn,n=t.canZoomOut;return T.a.createElement(kt,{actions:[{type:"button",id:"zoom-in",active:!1,disabled:!1===a,iconId:"icon-plus",label:e.get("map/zoomToolbar/zoomIn"),onClick:this.onZoomIn},{type:"button",id:"zoom-out",active:!1,disabled:!1===n,iconId:"icon-minus",label:e.get("map/zoomToolbar/zoomOut"),onClick:this.onZoomOut}]})}}]),t}(T.a.Component);f()(Ot,"contextTypes",_.a.childContextTypes);a("R+T3");var Bt=a("g6Z0"),Rt=a("hoJM"),Dt=a("gpXz"),At="".concat(We.a," ").concat("15px"," ").concat(Ae),zt=function(e){function t(e){var a;o()(this,t),a=r()(this,s()(t).call(this)),f()(u()(a),"olFeature",void 0),f()(u()(a),"coordinates",void 0),f()(u()(a),"location",void 0),f()(u()(a),"resolution",-1),f()(u()(a),"styles",[]);var n=e.mapProjectionCode,i=e.location;return a.location=i,a.olFeature=new Je.a({geometry:new Ke.a(le(n,i.position))}),a.coordinates=a.olFeature.getGeometry().getCoordinates(),a}return h()(t,e),m()(t,[{key:"getStyle",value:function(e){return this.resolution===e&&this.styles.length>0?this.styles:(this.resolution=e,this.styles=[],this.createCrosshairDebugStyle(),this.createLocationPinStyles(),this.createLocationNameStyle(),this.styles)}},{key:"createCrosshairDebugStyle",value:function(){}},{key:"createLocationNameStyle",value:function(){this.styles.push(new De.b({text:new Dt.a({text:this.location.name,offsetY:10,fill:new Bt.a({color:"#000000"}),stroke:new Rt.a({color:"rgba(238, 238, 238, 0.75)",width:4}),font:At})}))}},{key:"createLocationPinStyles",value:function(){this.styles.push(new De.b({geometry:new Ke.a([this.coordinates[0],this.coordinates[1]+0*this.resolution]),image:new Re.a({src:"/assets/images/map/shadow.png",scale:.4})})),this.styles.push(new De.b({geometry:new Ke.a([this.coordinates[0],this.coordinates[1]+0*this.resolution]),image:new Re.a({anchor:[.5,1],src:"/assets/images/map/pin.png",scale:.4})}))}}]),t}(fe.a),Wt=function(e){function t(e,a,n,i){var c;return o()(this,t),c=r()(this,s()(t).call(this)),f()(u()(c),"currentLocationFeature",void 0),f()(u()(c),"map",void 0),f()(u()(c),"mapExtent",void 0),f()(u()(c),"mapProjectionCode",void 0),f()(u()(c),"vectorLayer",void 0),f()(u()(c),"vectorSource",void 0),f()(u()(c),"getStyle",(function(e,t){return c.currentLocationFeature.getStyle(t)})),c.map=e,c.mapProjectionCode=a,c.mapExtent=n,c.vectorSource=new Be.a,c.vectorLayer=new Oe.a({extent:c.mapExtent,source:c.vectorSource,style:c.getStyle,zIndex:re}),c.currentLocationFeature=new zt({mapProjectionCode:c.mapProjectionCode,location:i}),c.vectorSource.addFeature(c.currentLocationFeature.olFeature),c.map.addLayer(c.vectorLayer),c}return h()(t,e),m()(t,[{key:"show",value:function(){this.vectorLayer.setOpacity(1)}},{key:"hide",value:function(){this.vectorLayer.setOpacity(0)}},{key:"destroy",value:function(){this.map.removeLayer(this.vectorLayer),this.vectorSource=null,this.vectorLayer=null}}]),t}(fe.a),Zt=a("SAzV"),Ht=(a("eTy8"),a("LvFn")),Ut=function(e){function t(e){var a;return o()(this,t),a=r()(this,s()(t).call(this)),f()(u()(a),"added",!1),f()(u()(a),"error",!1),f()(u()(a),"loaded",!1),f()(u()(a),"debugLayer",void 0),f()(u()(a),"layer",void 0),f()(u()(a),"mapExtent",void 0),f()(u()(a),"mapProjectionCode",void 0),f()(u()(a),"outstanding",0),f()(u()(a),"source",void 0),f()(u()(a),"onLoadStart",(function(){a.outstanding++})),f()(u()(a),"onLoaded",(function(){a.outstanding--,0===a.outstanding&&!1===a.loaded&&(a.loaded=!0,a.emit("loaded"))})),f()(u()(a),"onLoadError",(function(){a.outstanding--,a.error=!0,a.emit("error")})),a.mapProjectionCode=e.mapProjectionCode,a.mapExtent=e.mapExtent,a.source=a.createOlSource(e.url,e.tileLevels),a.layer=new Zt.a({source:a.source}),a.setOpacity(0),a}return h()(t,e),m()(t,[{key:"add",value:function(e,t){this.added||(this.added=!0,e.addLayer(this.layer),void 0!==t&&this.layer.setZIndex(t))}},{key:"remove",value:function(e){this.added&&(this.added=!1,e.removeLayer(this.layer)),this.removeTileDebugLayer(e)}},{key:"addTileDebugLayer",value:function(e,t){}},{key:"removeTileDebugLayer",value:function(e){}},{key:"destroy",value:function(){this.source.un("tileloadstart",this.onLoadStart),this.source.un("tileloadend",this.onLoaded),this.source.un("tileloaderror",this.onLoadError),this.source=null,this.layer=null,this.removeAllListeners()}},{key:"setOpacity",value:function(e){this.layer.setOpacity(e)}},{key:"createOlSource",value:function(e,t){if(!this.source){var a=new Ht.a({url:e,cacheSize:256,projection:se(this.mapProjectionCode,this.mapExtent),tileSize:[512,512],minZoom:t.min,maxZoom:t.max,zDirection:0});a.on("tileloadstart",this.onLoadStart),a.on("tileloadend",this.onLoaded),a.on("tileloaderror",this.onLoadError),this.source=a}return this.source}}]),t}(fe.a),Gt=a("fAui"),Vt=a("vIFP"),Yt=a("4XSy");a.d(t,"UnconnectedMapContainer",(function(){return Xt})),a.d(t,"MapContainer",(function(){return qt})),y.a.defs("EPSG:3575","+proj=laea +lat_0=90 +lon_0=10 +x_0=0 +y_0=0 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"),Object(Vt.a)(y.a);var Xt=function(e){function t(e){var a;o()(this,t),a=r()(this,s()(t).call(this,e)),f()(u()(a),"globalErrorHandler",void 0),f()(u()(a),"mapContainerTilesContainerRef",T.a.createRef()),f()(u()(a),"mapLayers",[]),f()(u()(a),"mounted",!1),f()(u()(a),"initializeMap",(function(){var e=a.props,t=e.location,n=e.mapType,o=a.state,i=o.mapExtent,r=o.mapProjectionCode,c=o.mapViewExtent,s=x.a.map;if(a.mapContainerTilesContainerRef.current){var l=function(e,t,a,n,o){var i=le(a,t),r=Object(Y.i)(a),c=new q.a({center:i,extent:n,maxZoom:o.max,minZoom:o.min,projection:r,units:"meters",zoom:o.default}),s=Object(G.a)({altShiftDragRotate:!1,pinchRotate:!1});return new V.a({controls:[],interactions:s,layers:[],target:e,view:c})}(a.mapContainerTilesContainerRef.current,t.position,r,c,s.zoomLevels[n]),u=new Wt(l,r,i,t);a.setState({map:l,currentLocationFeatureLayer:u,baseLayersState:"BASE_LAYERS_LOADING"},a.loadBaseLayers)}})),f()(u()(a),"destroyMap",(function(){var e=a.state.map;a.mapLayers.forEach((function(e){e.destroy()})),e&&e.setTarget(null)})),f()(u()(a),"loadBaseLayers",(function(){var e=a.state,t=e.map,n=e.mapExtent,o=e.mapProjectionCode,i=a.props.mapProjection,r=x.a.map.tileLevels[i],c=[{url:x.a.external.map[i].base,zIndex:ne},{url:x.a.external.map[i].outline,zIndex:ie}];a.mapLayers=c.map((function(e){var i=new Ut({mapProjectionCode:o,mapExtent:n,url:e.url,tileLevels:r});return i.add(t,e.zIndex),i.setOpacity(1),i.loaded?a.onBaseLayerLoaded():i.once("loaded",a.onBaseLayerLoaded),i}))})),f()(u()(a),"onZoomAnimateEnd",(function(){var e=a.props.mapType,t=a.state.map;if(!1!==a.mounted&&null!=t){var n=x.a.map,o=t.getView(),i=n.zoomLevels[e];o.setMinZoom(i.min),o.setMaxZoom(i.max)}})),f()(u()(a),"onChangeMapDescription",(function(e){a.setState({mapDescription:e})})),f()(u()(a),"onBaseLayerLoaded",(function(){a.mapLayers.every((function(e){return e.loaded}))&&a.setState({baseLayersState:"BASE_LAYERS_READY",showLoadingIndicator:!1},a.onBaseLayersReady)})),f()(u()(a),"onBaseLayersReady",(function(){a.addTileDebugLayer()})),f()(u()(a),"onError",(function(e,t,n,o,i){a.mounted&&a.setState({hasError:!0}),a.globalErrorHandler&&a.globalErrorHandler.call(u()(a),e,t,n,o,i)}));var n=e.mapProjection,i=e.mapType;return a.state={baseLayersState:"BASE_LAYERS_INITIAL",currentLocationFeatureLayer:void 0,hasError:!1,map:void 0,mapExtent:"lambert"===n?K:ee,mapProjectionCode:"lambert"===n?J:$,mapType:i,mapViewExtent:"lambert"===n?Q:te,showLoadingIndicator:!0},a}return h()(t,e),m()(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){return t.mapType!==e.mapType?{mapDescription:"",mapType:e.mapType}:{}}}]),m()(t,[{key:"componentDidMount",value:function(){this.mounted=!0,setTimeout(this.initializeMap),this.globalErrorHandler=window.onerror,window.onerror=this.onError}},{key:"componentWillUnmount",value:function(){this.mounted=!1,this.globalErrorHandler&&(window.onerror=this.globalErrorHandler),this.destroyMap()}},{key:"componentDidUpdate",value:function(e){var t=this,a=this.props,n=a.location,o=a.showHeader,i=a.mapType,r=this.state,c=r.map,s=r.mapProjectionCode;if(e.showHeader!==o&&setTimeout((function(){!0===t.mounted&&c.updateSize()}),100),c&&e.mapType!==i){var l=x.a.map,u=c.getView(),d=l.zoomLevels[e.mapType],m=l.zoomLevels[i];u.setMinZoom(Math.min(d.min,m.min)),u.setMaxZoom(Math.max(d.max,m.max)),u.animate({center:le(s,n.position),zoom:m.default,duration:ae},this.onZoomAnimateEnd)}}},{key:"render",value:function(){var e=this.context.locale,t=this.props,a=t.currentMapFeature,n=t.location,o=t.mapType,i=t.mapProjection,r=t.nowIndex,c=t.onToggleHeader,s=t.radarStatus,l=t.showHeader,u=t.supportsPrecipitation,d=t.times,m=this.state,p=m.baseLayersState,h=m.currentLocationFeatureLayer,v=m.hasError,f=m.map,g=m.mapDescription,y=m.mapExtent,b=m.mapProjectionCode,x=m.showLoadingIndicator,F=f&&"radar"===o,E=f&&"weather"===o,S=f&&u,L=e.get("map/types/".concat(o,"/name")),_=g?"".concat(L,". ").concat(g):L;return v?null:T.a.createElement("div",{className:"map-container"},T.a.createElement("div",{className:"map-container__content"},T.a.createElement("div",{"aria-label":_,className:"map-container__tiles-container",ref:this.mapContainerTilesContainerRef,role:"img",tabIndex:0}),"BASE_LAYERS_READY"===p&&T.a.createElement(T.a.Fragment,null,!1===s.isActive&&T.a.createElement(Ct,{active:F,map:f,mapProjectionCode:b,nowIndex:r,radarStatus:s,times:d}),a&&T.a.createElement(st,{active:E,currentLocationFeatureLayer:h,currentMapFeature:a,map:f,mapExtent:y,mapProjection:i,mapProjectionCode:b,onChangeMapDescription:this.onChangeMapDescription}),T.a.createElement("div",{"aria-hidden":"true",className:"map-container__scale-line"},T.a.createElement(Tt,{map:f})),T.a.createElement("div",{className:"map-container__fullscreen-button"},T.a.createElement(It,{iconId:l?"icon-expand":"icon-collapse",label:l?e.get("grammar/maximize"):e.get("grammar/minimize"),onClick:c})),T.a.createElement("div",{className:"map-container__zoom-toolbar"},T.a.createElement(Ot,{map:f,mapType:o})),S&&T.a.createElement("div",{className:"map-container__map-type-toolbar"},T.a.createElement(jt,{location:n,mapType:o}))),x&&T.a.createElement(w.a,null)))}},{key:"addTileDebugLayer",value:function(){this.state.map}}]),t}(T.a.Component);f()(Xt,"contextTypes",_.a.childContextTypes),f()(Xt,"defaultProps",{times:[]});var qt=Object(b.a)(Object(rt.b)((function(e,t){var a=t.currentPage,n=t.currentPageSettings.showHeader,o=Object(Gt.a)(a.details.params);return{mapProjection:Object(Yt.b)(e,o),currentMapFeature:Object(Yt.a)(e,o),showHeader:n}}))(Xt))},"D/Uy":function(e,t,a){"use strict";a.r(t);var n=a("lwsE"),o=a.n(n),i=a("W8MJ"),r=a.n(i),c=a("a1gu"),s=a.n(c),l=a("Nsbk"),u=a.n(l),d=a("PJYZ"),m=a.n(d),p=a("7W2i"),h=a.n(p),v=a("lSNA"),f=a.n(v),g=a("v8/g"),y=a("q3Wi"),b=a("4eNS"),x=a("q1tI"),w=a.n(x),F=a("/MKj"),E=a("S8kc"),S=a("4XSy"),L=a("Wwog"),_=a("yGI6");var C=Object(L.a)((function(e){if(!e.radarPrecipitationIntensityNordic)return{nowIndex:-1,times:[]};var t={nowIndex:e.radarPrecipitationIntensityNordic.times.length-1,times:[]},a=!0,n=!1,o=void 0;try{for(var i,r=e.radarPrecipitationIntensityNordic.times[Symbol.iterator]();!(a=(i=r.next()).done);a=!0){var c=i.value;t.times.push({diffFromNow:0,modelTime:e.radarPrecipitationIntensityNordic.modelTime,time:c,type:"radar_precipitation_intensity_nordic"})}}catch(e){n=!0,o=e}finally{try{a||null==r.return||r.return()}finally{if(n)throw o}}if(e.radarNowcast&&e.radarNowcast.times.length>0){t.nowIndex=e.radarPrecipitationIntensityNordic.times.length;var s=!0,l=!1,u=void 0;try{for(var d,m=e.radarNowcast.times[Symbol.iterator]();!(s=(d=m.next()).done);s=!0){var p=d.value;t.times.push({diffFromNow:0,modelTime:e.radarNowcast.modelTime,time:p,type:"radar_nowcast"})}}catch(e){l=!0,u=e}finally{try{s||null==m.return||m.return()}finally{if(l)throw u}}}if(0===t.times.length)return t;var h=_.a.create(t.times[t.nowIndex].time),v=!0,f=!1,g=void 0;try{for(var y,b=t.times[Symbol.iterator]();!(v=(y=b.next()).done);v=!0){var x=y.value;x.diffFromNow=_.a.create(x.time).diff(h,"minutes")}}catch(e){f=!0,g=e}finally{try{v||null==b.return||b.return()}finally{if(f)throw g}}for(var w=0,F=0;F<t.times.length;F++)t.times[F].diffFromNow<=-90&&(w=F);for(var E=t.times.length-1,S=t.times.length-1;S>=0;S--)t.times[S].diffFromNow>=90&&(E=S);return t.times=t.times.slice(w,E+1),t.nowIndex=t.nowIndex-w,t})),M=function(e){return e.radar},T=function(e){return M(e).status},I=function(e){var t=M(e);return C(t)},N=a("fAui");function k(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var P=a("7icJ").MapContainer,j=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return a=s()(this,(e=u()(t)).call.apply(e,[this].concat(i))),f()(m()(a),"onToggleHeader",(function(){var e=a.props;(0,e.setCurrentPageSettings)(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?k(Object(a),!0).forEach((function(t){f()(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):k(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},e.currentPageSettings,{showHeader:!e.showHeader}))})),f()(m()(a),"renderChildren",(function(){var e=a.context.locale,t=a.props,n=t.location,o=t.mapType,i=t.radarData,r=t.radarStatus,c=t.supportsPrecipitation,s=t.isFirstRender;if(!n)return null;var l="radar"===o&&!1===c,u=!1===s&&n&&!1===l;return w.a.createElement(w.a.Fragment,null,u&&w.a.createElement("div",{className:"map__container"},w.a.createElement(P,{location:n,mapType:o,nowIndex:i.nowIndex,onToggleHeader:a.onToggleHeader,radarStatus:r,supportsPrecipitation:c,times:i.times})),l&&w.a.createElement("p",{className:"map__unavailable"},e.get("map/unavailable")),w.a.createElement("p",{className:"map__fallback"},e.get("map/fallback")))})),a}return h()(t,e),r()(t,[{key:"render",value:function(){return w.a.createElement(y.a,{isContainer:!0,renderChildren:this.renderChildren})}}]),t}(w.a.Component);f()(j,"contextTypes",b.a.childContextTypes),f()(j,"displayName","MapPageRoot");t.default=Object(g.a)(Object(F.b)((function(e,t){var a=t.currentPage,n=t.currentPageSettings,o=t.isFirstRender,i=a.details.params,r=i.pageId,c=i.subpageId,s=n.showHeader,l=Object(N.a)(a.details.params);return{isFirstRender:o,location:Object(E.g)(e,l),mapType:c,pageId:r,radarData:I(e),radarStatus:T(e),showHeader:s,supportsPrecipitation:Object(S.c)(e,l)}}))(j))},OaRz:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a("FBcu"),o=a("q1tI"),i=a.n(o),r=a("IOWe"),c=function(e){var t=e.id,a=e.onClick,o=e.size,c=void 0===o?"medium":o,s=e.className,l=Object(n.a)();return i.a.createElement(r.a,{id:t,type:"icon-button",iconId:"icon-info",className:s,size:c,visuallyHiddenLabel:l.get("components/infoButton/ariaLabel"),onClick:a})}},f2uF:function(e,t,a){"use strict";a.d(t,"a",(function(){return y}));var n=a("J4zp"),o=a.n(n),i=a("Px59"),r=a.n(i),c=a("Wvx4"),s=a("GqVX"),l=a("al9T"),u=a("GDKA"),d=a("FBcu"),m=a("l1Mp"),p=a("eAd9"),h=a.n(p),v=a("q1tI"),f=a.n(v),g=a("IOWe");function y(e){var t=e.ariaLabel,a=e.size,n=void 0===a?"large":a,i=e.title,p=e.children,y=Object(d.a)(),w=Object(s.b)(),F=w.history,E=w.isFirstRender,S=null!=w.previousPage,L=Object(v.useRef)(null),_=Object(v.useState)(E),C=o()(_,2),M=C[0],T=C[1];function I(){x(e)?e.onClose():!0!==S?F.replace(e.onCloseUrl):window.history.back()}Object(v.useEffect)((function(){return h.a.on(),T(!0),function(){h.a.off()}}),[]),Object(v.useEffect)((function(){function t(t){if(!Object(m.d)(t)&&(t.keyCode===m.b||t.keyCode===m.c)){if(x(e))return t.keyCode===m.b&&null!=e.onNavigatePrevious&&e.onNavigatePrevious(),void(t.keyCode===m.c&&null!=e.onNavigateNext&&e.onNavigateNext());var a=t.keyCode===m.b?e.previousUrl:e.nextUrl;null!=a&&F.replace(a)}}return document.body.addEventListener("keydown",t,!1),function(){document.body.removeEventListener("keydown",t,!1)}}),[e,F]);var N=f.a.createElement(g.a,{type:"icon-button",iconId:"icon-cross",size:"medium",className:"modal-dialog__close-button",visuallyHiddenLabel:y.get("grammar/close"),onClick:I});return!b(e)||!0!==E&&!1!==S||(N=f.a.createElement(g.a,{type:"icon-link",iconId:"icon-cross",size:"medium",className:"modal-dialog__close-button",href:e.onCloseUrl,visuallyHiddenLabel:y.get("grammar/close"),onClick:function(e){e.preventDefault(),I()}})),!1===M?null:f.a.createElement("div",{className:"modal-dialog modal-dialog--".concat(n),onClick:function(e){null!=L.current&&e.target instanceof HTMLElement&&(Object(u.b)(L.current,e.target)||I())}},f.a.createElement("div",{className:"modal-dialog__scroll-container"},f.a.createElement("div",{className:"modal-dialog__flex-container"},f.a.createElement(r.a,{forwardRef:L,className:"modal-dialog__dialog","aria-label":t,backdrop:!1,onDialogToggle:I},f.a.createElement("div",{className:"modal-dialog__content"},f.a.createElement("div",{className:"modal-dialog__header"},f.a.createElement("div",{className:"modal-dialog__header-content"},null!=i&&f.a.createElement("h2",{className:"modal-dialog__heading","aria-live":"polite"},i),N)),p),b(e)&&f.a.createElement(f.a.Fragment,null,e.previousUrl&&f.a.createElement("div",{className:"modal-dialog__navigation-button-container modal-dialog__navigation-button-container--previous"},f.a.createElement(l.b,{className:"modal-dialog__navigation-button",href:e.previousUrl,replaceHistoryState:!0},f.a.createElement("span",{className:"nrk-sr"},y.get("grammar/previous")),f.a.createElement(c.a,{id:"icon-left",size:7}))),e.nextUrl&&f.a.createElement("div",{className:"modal-dialog__navigation-button-container modal-dialog__navigation-button-container--next"},f.a.createElement(l.b,{className:"modal-dialog__navigation-button",href:e.nextUrl,replaceHistoryState:!0},f.a.createElement("span",{className:"nrk-sr"},y.get("grammar/next")),f.a.createElement(c.a,{id:"icon-right",size:7})))),x(e)&&f.a.createElement(f.a.Fragment,null,e.onNavigatePrevious&&f.a.createElement("div",{className:"modal-dialog__navigation-button-container modal-dialog__navigation-button-container--previous"},f.a.createElement(l.a,{className:"modal-dialog__navigation-button",onClick:e.onNavigatePrevious},f.a.createElement("span",{className:"nrk-sr"},y.get("grammar/previous")),f.a.createElement(c.a,{id:"icon-left",size:7}))),e.onNavigateNext&&f.a.createElement("div",{className:"modal-dialog__navigation-button-container modal-dialog__navigation-button-container--next"},f.a.createElement(l.a,{className:"modal-dialog__navigation-button",onClick:e.onNavigateNext},f.a.createElement("span",{className:"nrk-sr"},y.get("grammar/next")),f.a.createElement(c.a,{id:"icon-right",size:7}))))))),f.a.createElement("div",{className:"modal-dialog__backdrop"}))}function b(e){return!0===e.renderOnServer}function x(e){return!1===e.renderOnServer}},gvXC:function(e,t,a){"use strict";a.d(t,"a",(function(){return h})),a.d(t,"b",(function(){return v})),a.d(t,"c",(function(){return f}));var n=a("TWl/"),o=a.n(n),i=a("Xr/R"),r=a("TSYQ"),c=a.n(r),s=a("vD/x"),l=a("15E1"),u=a("FBcu"),d=a("wXRo"),m=a("q1tI"),p=a.n(m),h=function(e){var t=e.value,a=e.direction,n=e.decimal,o=void 0===n||n,r=e.displayUnit,m=void 0===r||r,h=e.displayArrow,g=void 0!==h&&h,y=e.color,b=void 0!==y&&y,x=e.className,w=e.valueClassName,F=e.unitClassName,E=e.renderScreenReaderLabel,S=void 0===E||E,L=Object(u.a)(),_=Object(d.a)(),C=i.a.units.wind,M=L.get("units/".concat(C,"/short")),T=L.get("units/".concat(C,"/long")),I=L.get("forecast/daily/headings/wind/long"),N=f({value:t,decimal:o}),k=v({value:t,decimal:o});return p.a.createElement("span",{className:c()("wind",x,{"wind--color":b,"wind--extreme":N}),role:"text"},S&&p.a.createElement("span",{className:"nrk-sr"},I),p.a.createElement("span",{className:c()("wind__value",w)},Object(l.b)(k,_,o)),m&&p.a.createElement("abbr",{className:c()("wind__unit",F),title:T},M),g&&p.a.createElement(s.a,{direction:a,speed:t,decimal:o,className:"wind__arrow"}))};function v(e){var t=e.value,a=e.decimal;return!0===(void 0===a||a)?t:o.a.round(t)}function f(e){var t=e.value,a=e.decimal;return v({value:t,decimal:void 0===a||a})>=i.a.extreme.wind}},"hd+n":function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return h})),a.d(t,"c",(function(){return v}));var n=a("TWl/"),o=a.n(n),i=a("Xr/R"),r=a("TSYQ"),c=a.n(r),s=a("15E1"),l=a("FBcu"),u=a("wXRo"),d=a("q1tI"),m=a.n(d),p=function(e){var t=e.className,a=void 0===t?"":t,n=e.value,o=e.decimal,r=void 0===o||o,d=e.color,p=void 0===d||d,f=e.renderScreenReaderLabel,g=void 0===f||f,y=Object(l.a)(),b=Object(u.a)(),x=i.a.units.temperature,w=y.get("units/".concat(x,"/long")),F=y.get("terminology/temperature/long"),E=h({value:n,decimal:r});return m.a.createElement("span",{className:c()("temperature",a,{"temperature--warm":p&&!0===v({value:n,decimal:r}),"temperature--cold":p&&!1===v({value:n,decimal:r})}),role:"text"},g&&m.a.createElement("span",{className:"temperature__label nrk-sr"},F),Object(s.b)(E,b,r),m.a.createElement("span",{className:"temperature__degree",title:w,"aria-label":w},"°"))};function h(e){var t=e.value,a=e.decimal;return!0===(void 0===a||a)?t:o.a.round(t)}function v(e){var t=e.value,a=e.decimal;return h({value:t,decimal:void 0===a||a})>0}},pMSu:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o}));var n=500,o=1280},q3Wi:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a("v8/g"),o=a("TSYQ"),i=a.n(o),r=a("WbkG"),c=a("C9W4"),s=a("q1tI"),l=a.n(s),u=Object(n.a)((function(e){var t=e.className,a=void 0===t?"":t,n=e.isContainer,o=void 0!==n&&n,s=e.renderChildren,u=void 0===s?c.a:s,d=e.renderModalChildren,m=void 0===d?c.a:d,p=e.currentPageSettings.isModal,h=u(),v=m();return l.a.createElement(r.a,null,l.a.createElement("div",{className:i()({"page-root":!0,"page-root--container":o}),role:"main"},l.a.createElement("div",{id:"page-content",className:"page-root__content ".concat(a),"aria-hidden":p},h),l.a.createElement("div",{id:"page-modal",className:"page-root__modal"},v)))}))},rsK4:function(e,t,a){"use strict";function n(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e.charAt(0).toUpperCase()+e.slice(1);return[e,"Webkit"+n,"Moz"+n,"O"+n,"ms"+n].forEach((function(e){a[e]=t})),a}a.d(t,"a",(function(){return n}))},tGdh:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return c})),a.d(t,"f",(function(){return s}));var n="#006edb",o="#9ecfff",i="#627982",r="#006edb",c="#c60000",s="#21292b"},"vD/x":function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a("Wvx4"),o=a("TSYQ"),i=a.n(o),r=a("NdCM"),c=a("FBcu"),s=a("rsK4"),l=a("q1tI"),u=a.n(l),d=a("gvXC");function m(e){var t=e.direction,a=e.speed,o=e.decimal,l=e.className,m=void 0===l?"":l,p=Object(c.a)(),h=null!=t?Object(s.a)("transform","rotate(".concat(t,"deg)")):void 0,v=Object(d.c)({value:a,decimal:o}),f=p.get("code"),g=null!=t?Object(r.c)(a,t,f):"";return u.a.createElement("figure",{className:i()(m,{"wind-arrow":!0,"wind-arrow--extreme":v})},u.a.createElement("div",{className:"wind-arrow__arrow-container"},u.a.createElement("span",{className:"nrk-sr"},g),u.a.createElement("span",{className:"wind-arrow__arrow","aria-hidden":!0,style:h},null!=t&&u.a.createElement(n.a,{id:"icon-arrow",size:3}))))}}}]);
//# sourceMappingURL=lib-components-MapPageRoot-MapPageRoot-e082b62bf4731b9e1383.js.map