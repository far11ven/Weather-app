/*! Core Analytics v5.0.4 - Copyright (c) 2015-2019 NRK */
!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):((e=e||self).CA5=e.CA5||{},e.CA5["core-analytics"]=n())}(this,function(){"use strict";var r="https://static.nrk.no/core-analytics/major/5",s="CA5",n="5.0.4";var e;(function(e,n){var t;t=function(){function g(){for(var e=arguments,n=0,t={};n<arguments.length;n++){var r=e[n];for(var o in r)t[o]=r[o]}return t}return function e(p){function m(e,n,t){var r;if("undefined"!=typeof document){if(1<arguments.length){if("number"==typeof(t=g({path:"/"},m.defaults,t)).expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*t.expires),t.expires=o}t.expires=t.expires?t.expires.toUTCString():"";try{r=JSON.stringify(n),/^[\{\[]/.test(r)&&(n=r)}catch(e){}n=p.write?p.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=(e=(e=encodeURIComponent(String(e))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape);var i="";for(var c in t)t[c]&&(i+="; "+c,!0!==t[c]&&(i+="="+t[c]));return document.cookie=e+"="+n+i}e||(r={});for(var a=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,s=0;s<a.length;s++){var d=a[s].split("="),f=d.slice(1).join("=");this.json||'"'!==f.charAt(0)||(f=f.slice(1,-1));try{var l=d[0].replace(u,decodeURIComponent);if(f=p.read?p.read(f,l):p(f,l)||f.replace(u,decodeURIComponent),this.json)try{f=JSON.parse(f)}catch(e){}if(e===l){r=f;break}e||(r[l]=f)}catch(e){}}return r}}return(m.set=m).get=function(e){return m.call(m,e)},m.getJSON=function(){return m.apply({json:!0},[].slice.call(arguments))},m.defaults={},m.remove=function(e,n){m(e,"",g(n,{expires:-1}))},m.withConverter=e,m}(function(){})},e.exports=t()})(e={exports:{}},e.exports),function(){if("undefined"==typeof window)return;var e=window.Element.prototype,n=e.matches||e.msMatchesSelector||e.webkitMatchesSelector}();var d="data-core-analytics";if("undefined"!=typeof window){var t="coreAnalytics",o=window[t]||!1;o.version||(window[t]=f()),o.q&&o.q.forEach(function(e){return window[t].apply(window,e)})}function f(){var o=[],i=[],t=Object.create(null),c=Object.create(null),e=Object.create(null),a=!1,u=function(n,t){if("function"==typeof n){var e=1<o.index?1-o.index:o.length;o.splice(e,0,n),a&&setTimeout(function(){return o.index||u.next()})}else{var r=function(){var e=c[n]||[];e.length||u.log("Missing handler for action "+n),i.push({type:n,args:t}),e.forEach(function(e){return e(t,u,n)})};if("initialize"===n){if(a)return u("error",new Error("Tracker is already initialized"));a=!0,o.unshift(r),setTimeout(u.next)}else u(r),u(function(){return i.pop()})}};return u.version=n,u.create=f,u.set=function(n,e){"object"==typeof n?Object.keys(n).forEach(function(e){return u.set(e,n[e])}):t[n]=e},u.get=function(e){return e?t[e]:t},u.on=function(n,t){(c[n]=c[n]||[]).push(t),i.forEach(function(e){return e.type===n&&t(e.args,u,n)})},u.off=function(e,n){c[e]=(c[e]||[]).filter(function(e){return n&&e!==n})},u.log=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];u.debug&&console.log.apply(console,["%c"+u.uuid+":","font-weight:bold"].concat(e))},u.load=function(t,r){e[r]||(e[r]=!0,u(function(){return function(e){var n=e.src,t=e.onload;void 0===t&&(t=Function.prototype);var r=e.crossorigin;void 0===r&&(r=!0);var o=document.querySelector('script[src="'+n+'"]')||document.createElement("script"),i=o.queue=o.queue||[];i.length?i.push(t):o.parentNode?t(o):(i.push(t),o.async=!0,o.onload=function(){return i.splice(0).forEach(function(e){return e(o)})},o.setAttribute("src",n),r&&-1===n.indexOf("//localhost")&&o.setAttribute("crossorigin","anonymous"),document.head.appendChild(o))}({src:t,onload:function(e){u.log("Loading "+t);var n=r.split(".").reduce(function(e,n){return e&&e[n]},window);"function"==typeof n?n(u):u("error",new Error("Expected "+e.src+" to expose function at window."+r)),u.next()}}),!1}))},u.next=function(){var e=o.index=o.length,n=o.shift(),t=e&&n(u);t&&"function"==typeof t.then?t.then(u.next):e&&!1!==t&&u.next()},u.contains=function(e){for(var n=e;n;n=n.parentElement)if(n.hasAttribute(d))return n.getAttribute(d)===u.uuid&&e;return!1},u.on("error",function(e){return console.error("%c"+(u.uuid||"Core Analytics")+":","font-weight:bold",e.message)}),u.on("context",function(e){return"userId"in e&&u.set("userId",e.userId)}),u.on("pageview",function(e){return void 0===e&&(e={}),e.tnsSection&&u.load(r+"/statistics/tns.min.js",s+".statistics/tns")}),u.on("recommendations",function(){return u.load(r+"/recommendations/ecommerce.min.js",s+".recommendations/ecommerce")}),u.on("optimize",function(e){e.optimizeId;return u.load(r+"/experiments/optimize.min.js",s+".experiments/optimize")}),u.on("timespent",function(){return u.load(r+"/engagement/timespent.min.js",s+".engagement/timespent")}),u.on("initialize",function(e){if(/\W/.test(e.trackerName))return u("error",new Error("trackerName can only contain alphanumeric characters"));var n=e.container||document.documentElement;u.uuid="ca_"+(e.trackerName||Math.round(Date.now()*Math.random()).toString(32)),n.setAttribute(d,u.uuid),u.set({userId:e.userId,parentId:e.parentId,clientId:e.clientId}),"debug"in e&&u.log("Debug:",u.debug=Boolean(e.debug)),e.ga&&u.load(r+"/statistics/analytics.min.js",s+".statistics/analytics")}),u}return f()});
//# sourceMappingURL=core-analytics.min.js.map
